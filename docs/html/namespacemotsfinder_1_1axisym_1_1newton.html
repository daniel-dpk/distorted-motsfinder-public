<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MOTS Finder: motsfinder.axisym.newton Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxystyle_tweaks.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MOTS Finder
   </div>
   <div id="projectbrief">Find non-star-shaped MOTSs</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('namespacemotsfinder_1_1axisym_1_1newton.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">motsfinder.axisym.newton Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Implementation of a Newton-Kantorovich method to find MOTSs.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmotsfinder_1_1axisym_1_1newton_1_1__LinearExpansionEquation.html">_LinearExpansionEquation</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the linearized expansion equation and keep track of results.  <a href="classmotsfinder_1_1axisym_1_1newton_1_1__LinearExpansionEquation.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmotsfinder_1_1axisym_1_1newton_1_1InsufficientResolutionOrRoundoff.html">InsufficientResolutionOrRoundoff</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Raised when resolution is too low or roundoff prevents convergence.  <a href="classmotsfinder_1_1axisym_1_1newton_1_1InsufficientResolutionOrRoundoff.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmotsfinder_1_1axisym_1_1newton_1_1NewtonKantorovich.html">NewtonKantorovich</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Class implementing the Newton-Kantorovich steps.  <a href="classmotsfinder_1_1axisym_1_1newton_1_1NewtonKantorovich.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmotsfinder_1_1axisym_1_1newton_1_1NoConvergence.html">NoConvergence</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Base for exceptions indicating failed convergence of Newton steps.  <a href="classmotsfinder_1_1axisym_1_1newton_1_1NoConvergence.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmotsfinder_1_1axisym_1_1newton_1_1StepLimitExceeded.html">StepLimitExceeded</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Raised when convergence not achieved within the step count limit.  <a href="classmotsfinder_1_1axisym_1_1newton_1_1StepLimitExceeded.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a07bd447136c9537221096f7c8ef3384a"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemotsfinder_1_1axisym_1_1newton.html#a07bd447136c9537221096f7c8ef3384a">newton_kantorovich</a> (initial_curve, c=0.0, steps=50, step_mult=0.5, rtol=0, atol=1e-12, accurate_test_res=500, auto_resolution=True, max_resolution=1000, linear_regime_threshold=1e-2, mat_solver='scipy.solve', fake_steps=3, plot_steps=False, reference_curves=(), plot_deltas=False, verbose=False, disp=True, parallel=False, kw)</td></tr>
<tr class="memdesc:a07bd447136c9537221096f7c8ef3384a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Do a Newton type search to find a MOTS.  <a href="#a07bd447136c9537221096f7c8ef3384a">More...</a><br /></td></tr>
<tr class="separator:a07bd447136c9537221096f7c8ef3384a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implementation of a Newton-Kantorovich method to find MOTSs. </p>
<p>This module contains the Newton-Kantorovich finder <a class="el" href="namespacemotsfinder_1_1axisym_1_1newton.html#a07bd447136c9537221096f7c8ef3384a" title="Do a Newton type search to find a MOTS. ">newton_kantorovich()</a>, which is a high-level function to search for MOTSs based on an initial guess.</p>
<p>A basic description of the method can be found in <a class="el" href="namespacemotsfinder_1_1axisym_1_1newton.html#boyd2001">[1]</a>, Appendix C, and in <a class="el" href="namespacemotsfinder_1_1axisym_1_1newton.html#pookkolb2018_1">[2]</a>.</p>
<p><b>Examples</b> </p>
<div class="fragment"><div class="line">metric = BrillLindquistMetric(m1=1, m2=1, d=1.4, axis=<span class="stringliteral">&#39;z&#39;</span>)</div><div class="line">c0 = StarShapedCurve.create_sphere(radius=2.0, num=100, metric=metric)</div><div class="line">c_AH = newton_kantorovich(c0, verbose=<span class="keyword">True</span>)</div><div class="line">c_AH.plot(label=<span class="stringliteral">&#39;AH&#39;</span>)</div></div><!-- fragment --><p><b>References</b> </p>
<p><a class="anchor" id="boyd2001"></a>[1] Boyd, J. P. "Chebyshev and Fourier Spectral Methods.
     Dover Publications Inc." New York (2001).</p>
<p><a class="anchor" id="pookkolb2018_1"></a>[2] D. Pook-Kolb, O. Birnholtz, B. Krishnan and E. Schnetter, "The existence and stability of marginally trapped surfaces." arXiv:1811.10405 [gr-qc]. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a07bd447136c9537221096f7c8ef3384a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07bd447136c9537221096f7c8ef3384a">&#9670;&nbsp;</a></span>newton_kantorovich()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def motsfinder.axisym.newton.newton_kantorovich </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>initial_curve</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>c</em> = <code>0.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>steps</em> = <code>50</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>step_mult</em> = <code>0.5</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rtol</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>atol</em> = <code>1e-12</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>accurate_test_res</em> = <code>500</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>auto_resolution</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>max_resolution</em> = <code>1000</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>linear_regime_threshold</em> = <code>1e-2</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>mat_solver</em> = <code>'scipy.solve'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fake_steps</em> = <code>3</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>plot_steps</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>reference_curves</em> = <code>()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>plot_deltas</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>verbose</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>disp</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>parallel</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>kw</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Do a Newton type search to find a MOTS. </p>
<p>This function performs scaled Newton steps to solve the nonlinear problem of finding a MOTS.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">initial_curve</td><td>(ExpansionCurve subclass) Initial guess for the trial surface. The current resolution of the horizon function in this curve will be used for solving the linear problem for each step. The specific type of this curve determines the parameterization of the curve. Also, this curve knows its geometry, so the metric does not need to be supplied here. </td></tr>
    <tr><td class="paramname">c</td><td>(float, optional) The target expansion. Default is <code>0</code>, i.e. we're trying to find MOTSs. If nonzero, constant expansion surfaces are found. </td></tr>
    <tr><td class="paramname">steps</td><td>(int, optional) Maximum number of Newton steps to take. Default is <code>50</code>. </td></tr>
    <tr><td class="paramname">step_mult</td><td>(float, optional) Factor to multiply the Newton steps with. </td></tr>
    <tr><td class="paramname">rtol</td><td>Float indicating when to stop taking more steps. If the maximum expansion (or its deviation from <code>c</code>) divided by the maximum expansion of the initial evaluation is less or equal to <code>rtol</code>, we consider the Newton steps to have converged. Default is <code>0</code>. </td></tr>
    <tr><td class="paramname">atol</td><td>Float indicating the absolute expansion below which we stop taking more Newton steps. Default is <code>1e-12</code>. </td></tr>
    <tr><td class="paramname">accurate_test_res</td><td>Number of samples to check the expansion at to decide upon convergence. If <code>'twice'</code>, uses two times the curve's resolution. If zero or <code>None</code>, convergence is only checked at the collocation points and <code>auto_resolution</code> has no effect. Default is <code>500</code>. </td></tr>
    <tr><td class="paramname">auto_resolution</td><td>Boolean indicating whether the resolution should be increased if insufficient resolution is detected. Default: <code>True</code>. </td></tr>
    <tr><td class="paramname">max_resolution</td><td>Maximum resolution to increase to. Failure to converge at this resolution will terminate the search. Default: <code>1000</code>. </td></tr>
    <tr><td class="paramname">linear_regime_threshold</td><td>Float indicating the absolute (see <code>atol</code>) expansion below which we take full Newton steps to accelerate convergence. Default is <code>1e-2</code>. </td></tr>
    <tr><td class="paramname">mat_solver</td><td>(string, optional) Matrix solver method to use. Default is <code>'scipy.solve'</code>, which is a fast solver with floating point accuracy. See ..<a class="el" href="namespacemotsfinder_1_1ndsolve_1_1solver.html#aa9b143582d20b970c4f3001cad8fa3b5" title="Numerically solve a linear differential equation. ">ndsolve.solver.ndsolve()</a> for more information. </td></tr>
    <tr><td class="paramname">fake_steps</td><td>Number of additional steps taken when the solution has converged at the collocation points but not yet between them. After these steps, the resolution is increased (or the search terminated). </td></tr>
    <tr><td class="paramname">plot_steps</td><td>(boolean, optional) Whether to plot each Newton step. Default is <code>False</code>. </td></tr>
    <tr><td class="paramname">reference_curves</td><td>(iterable, optional) Iterable of <code>(curve, options)</code> pairs to be plotted together with each step for comparison. The options part should either be a label string or a <code>dict</code> with options to be passed to <code>plot_curve</code>. </td></tr>
    <tr><td class="paramname">plot_deltas</td><td>(boolean, optional) Whether to plot the individual pseudospectral solutions of the linear problems. Default is <code>False</code>. </td></tr>
    <tr><td class="paramname">verbose</td><td>Whether to print status information during the Newton search. Default is <code>False</code>. </td></tr>
    <tr><td class="paramname">disp</td><td>Whether to raise <a class="el" href="classmotsfinder_1_1axisym_1_1newton_1_1NoConvergence.html" title="Base for exceptions indicating failed convergence of Newton steps. ">NoConvergence</a> (or subclasses) when the desired tolerance could not be reached in the number of steps or resolution. Default is <code>True</code>. </td></tr>
    <tr><td class="paramname">parallel</td><td>Whether to evaluate the equation using multiple processes in parallel. If <code>True</code>, uses all available threads. If an integer, uses that many threads. Default is <code>False</code>, i.e. don't compute in parallel. </td></tr>
    <tr><td class="paramname">**kw</td><td>Remaining keyword arguments are set as attributes on the solver object. They are documented as public class attributes of <a class="el" href="classmotsfinder_1_1axisym_1_1newton_1_1NewtonKantorovich.html" title="Class implementing the Newton-Kantorovich steps. ">NewtonKantorovich</a>. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacemotsfinder.html">motsfinder</a></li><li class="navelem"><a class="el" href="namespacemotsfinder_1_1axisym.html">axisym</a></li><li class="navelem"><a class="el" href="namespacemotsfinder_1_1axisym_1_1newton.html">newton</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
