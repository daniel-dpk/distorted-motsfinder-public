<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MOTS Finder: Example: MOTSs in Brill-Lindquist initial data</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxystyle_tweaks.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MOTS Finder
   &#160;<span id="projectnumber">v1.4-4-g8c2eec1</span>
   </div>
   <div id="projectbrief">Find non-star-shaped MOTSs</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md_docs_input_examples_bl.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Example: MOTSs in Brill-Lindquist initial data </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><blockquote class="doxtable">
<p><b>IMPORTANT</b></p>
<p>See <a class="el" href="md_docs_input_examples_init.html">Preparation to running the examples</a> for setting up (necessary imports, etc). </p>
</blockquote>
<h1>Example 0 &ndash; Creating a metric</h1>
<p>This shows how to create various metrics to use with the MOTS finder. No MOTS is found here.</p>
<div class="fragment"><div class="line"><span class="comment"># Schwarzschild `t=const` slice in isotropic coordinates:</span></div>
<div class="line">g = SchwarzschildSliceMetric(2.0) <span class="comment"># the only parameter is mass</span></div>
<div class="line"> </div>
<div class="line"><span class="comment"># Schwarzschild `t=const` slice in Kerr-Schild coordinates:</span></div>
<div class="line">g = SchwarzschildKSSlice(2.0) <span class="comment"># the only parameter is mass</span></div>
<div class="line"> </div>
<div class="line"><span class="comment"># Brill-Lindquist metric of two non-spinning BHs at rest:</span></div>
<div class="line">g = BrillLindquistMetric(d=0.5, m1=0.2, m2=0.8)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Kerr `t=const` slice in Kerr-Schild coordinates:</span></div>
<div class="line">gKerr = KerrKSSlice(M=1.0, a=0.5)</div>
<div class="line"><span class="comment"># NOTE: The above can only be used with finite difference differentiation.</span></div>
<div class="line"><span class="comment">#       See below for details.</span></div>
<div class="line"> </div>
<div class="line"><span class="comment"># Metric from numerical simulation data in SimulationIO format:</span></div>
<div class="line">g = SioMetric(<span class="stringliteral">&#39;the/simulation/file.it0000001234.s5&#39;</span>)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Metric from a set of component matrices.</span></div>
<div class="line"><span class="comment"># See the documentation of `motsfinder.discrete.construct.metric_from_data()`.</span></div>
<div class="line">fname_data = <span class="stringliteral">&#39;data/my_numerical_metric_data.npy&#39;</span></div>
<div class="line">g = metric_from_data(</div>
<div class="line">    fname_data, res=res, origin=origin,</div>
<div class="line">    metric=[g_xx, g_xy, g_xz, g_yy, g_yz, g_zz],</div>
<div class="line">    curv=[K_xx, K_xy, K_xz, K_yy, K_yz, K_zz],</div>
<div class="line">    lapse=lapse,</div>
<div class="line">    shift=[shift_x, shift_y, shift_z],</div>
<div class="line">)</div>
</div><!-- fragment --><p>If the metric does not support computing its first and second derivatives (e.g. the <a class="el" href="classmotsfinder_1_1metric_1_1analytical_1_1kerrks_1_1KerrKSSlice.html" title="Data for a slice of Kerr spacetime in Kerr-Schild coordinates.">motsfinder.metric.analytical.kerrks.KerrKSSlice</a> metric), you may wrap it in a finite difference calculator like this:</p>
<div class="fragment"><div class="line">gKerr = KerrKSSlice(M=1.0, a=0.5)</div>
<div class="line">g = FDDerivMetric(</div>
<div class="line">    metric=gKerr, <span class="comment"># metric to discretize</span></div>
<div class="line">    res=192,      <span class="comment"># resolution of finite difference method</span></div>
<div class="line">    fd_order=6    <span class="comment"># order of the finite difference method (can be 2, 4, 6, 8)</span></div>
<div class="line">)</div>
</div><!-- fragment --><h1>Example 1 &ndash; Axisymmetric non-star-shaped</h1>
<p>Here, we consider a Brill-Lindquist two black hole metric with mass parameters <code>m1 = 0.2</code>, <code>m2 = 0.8</code>, and distance parameter <code>d = 0.5</code> (see Ref [1] for more details on Brill-Lindquist data).</p>
<div class="fragment"><div class="line"><span class="comment"># This defines the metric for a mass-ratio 1:4 system with d = 0.5 M.</span></div>
<div class="line">g = BrillLindquistMetric(d=0.5, m1=0.2, m2=0.8)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># The initial guess dictates which MOTS is found. We create a sphere of a</span></div>
<div class="line"><span class="comment"># suitable radius to find the apparent horizon (AH).</span></div>
<div class="line">initial_guess = StarShapedCurve.create_sphere(</div>
<div class="line">    radius=(g.m1 + g.m2)/2. + g.d/3., <span class="comment"># just some guess based on parameters</span></div>
<div class="line">    origin=(0, 0, 0),</div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># To use the finder, we first create a search configuration.</span></div>
<div class="line"><span class="comment"># This is highly configurable, but we use one of the &quot;presets&quot; to have good</span></div>
<div class="line"><span class="comment"># defaults.</span></div>
<div class="line">cfg = GeneralMotsConfig.preset(</div>
<div class="line">    <span class="stringliteral">&#39;general&#39;</span>,      <span class="comment"># The preset to use. Any further settings override the</span></div>
<div class="line">                    <span class="comment"># preset settings.</span></div>
<div class="line">    metric=g,</div>
<div class="line">    num=50,         <span class="comment"># Initial resolution for the horizon function.</span></div>
<div class="line">    atol=1e-12,     <span class="comment"># Tolerance. The residual expansion must be below this</span></div>
<div class="line">                    <span class="comment"># value for the finder to stop.</span></div>
<div class="line">    reparam=<span class="keyword">False</span>,  <span class="comment"># Do not reparameterize the reference curve.</span></div>
<div class="line">    verbose=<span class="keyword">True</span>,   <span class="comment"># Print convergence messages.</span></div>
<div class="line">    <span class="comment">#plot_steps=True, # If you want to see all the Newton steps.</span></div>
<div class="line">    <span class="comment">#out_folder=&quot;data/my_MOTSs/&quot;, # If you want to save the found MOTS.</span></div>
<div class="line">    <span class="comment">#suffix=&quot;BL_d%s_m%s_%s&quot; % (g.d, g.m1, g.m2), # Make filename unique.</span></div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Start the actual finder.</span></div>
<div class="line">c_AH = find_mots(</div>
<div class="line">    cfg,</div>
<div class="line">    prefix=<span class="stringliteral">&#39;AH&#39;</span>,         <span class="comment"># The &quot;horizon name&quot; to be used as file name prefix.</span></div>
<div class="line">    c_ref=initial_guess, <span class="comment"># Use the initial guess as reference curve.</span></div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Plot the curve and how the coefficients converge.</span></div>
<div class="line">c_AH.plot()</div>
<div class="line">c_AH.plot_coeffs()</div>
<div class="line"> </div>
<div class="line"><span class="comment"># We can also plot the expansion along the curve.</span></div>
<div class="line">c_AH.plot_expansion()</div>
</div><!-- fragment --><p>As a next step, we find the two individual horizons.</p>
<div class="fragment"><div class="line"><span class="comment"># Find the smaller individual MOTS at z=+d/2.</span></div>
<div class="line">c_smaller = find_mots(</div>
<div class="line">    cfg,</div>
<div class="line">    prefix=<span class="stringliteral">&#39;smaller&#39;</span>, <span class="comment"># instead of &#39;AH&#39;</span></div>
<div class="line">    c_ref=StarShapedCurve.create_sphere(</div>
<div class="line">        radius=min(g.m1/2., g.d/2.), <span class="comment"># just some heuristics</span></div>
<div class="line">        origin=g.d/2.,               <span class="comment"># center the sphere on the upper puncture</span></div>
<div class="line">    ),</div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Find the larger individual MOTS at z=-d/2.</span></div>
<div class="line">c_larger = find_mots(</div>
<div class="line">    cfg,</div>
<div class="line">    prefix=<span class="stringliteral">&#39;larger&#39;</span>,</div>
<div class="line">    c_ref=StarShapedCurve.create_sphere(</div>
<div class="line">        radius=min(g.m2/2., g.d/2.),</div>
<div class="line">        origin=-g.d/2.,              <span class="comment"># center the sphere on the lower puncture</span></div>
<div class="line">    ),</div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Plot all three MOTSs together.</span></div>
<div class="line">BaseCurve.plot_curves(</div>
<div class="line">    (c_AH, <span class="stringliteral">r&quot;$\mathcal{S}_{\rm outer}$&quot;</span>, <span class="stringliteral">&#39;-b&#39;</span>),</div>
<div class="line">    (c_smaller, <span class="stringliteral">r&quot;$\mathcal{S}_1$&quot;</span>, <span class="stringliteral">&#39;:m&#39;</span>),</div>
<div class="line">    (c_larger, <span class="stringliteral">r&quot;$\mathcal{S}_2$&quot;</span>, <span class="stringliteral">&#39;--r&#39;</span>),</div>
<div class="line">    dpi=100, grid=<span class="keyword">False</span>, legendargs=dict(loc=4),</div>
<div class="line">)</div>
</div><!-- fragment --><p>Finding the inner common MOTS is easier at larger distances where it is much closer to the AH in shape. We can then vary the distance step by step and use the previous inner common MOTS as reference surface (and thus starting surface) for the search in the next step.</p>
<div class="fragment"><div class="line"><span class="comment"># First, find the AH when d=0.67. We&#39;ll use the previous AH as initial guess.</span></div>
<div class="line"><span class="comment"># Note that we downsample the reference curve significantly (using `ref_num`).</span></div>
<div class="line">g_larger_d = BrillLindquistMetric(d=0.67, m1=g.m1, m2=g.m2)</div>
<div class="line">c_AH_larger_d = find_mots(</div>
<div class="line">    cfg,</div>
<div class="line">    metric=g_larger_d,</div>
<div class="line">    c_ref=c_AH,</div>
<div class="line">    ref_num=10, <span class="comment"># this downsamples the reference curve to smooth it out</span></div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Next we find the inner common MOTS by stepping inward a little.</span></div>
<div class="line"><span class="comment"># The `offset_coeffs` define the coefficients `a_n` of the function we add:</span></div>
<div class="line"><span class="comment">#     sum_n{a_n cos(n lambda)}</span></div>
<div class="line">c_inner_larger_d = find_mots(</div>
<div class="line">    cfg, num=200, metric=g_larger_d, c_ref=c_AH_larger_d, ref_num=10,</div>
<div class="line">    offset_coeffs=(-0.2, 0, 0.05),</div>
<div class="line">    step_mult=0.3, <span class="comment"># do smaller steps initially to help with converging</span></div>
<div class="line">    <span class="comment">#plot_steps=True,</span></div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Now do a few steps in `d` to get to the desired value defined above.</span></div>
<div class="line"><span class="comment"># The argument `reparam=&#39;curv2&#39;` activates curvature-based reparameterization</span></div>
<div class="line"><span class="comment"># of the reference curve to make sure the collocation points are evenly</span></div>
<div class="line"><span class="comment"># distributed (with higher density in highly curved regions).</span></div>
<div class="line">c_inner = c_inner_larger_d.copy()</div>
<div class="line"><span class="keywordflow">for</span> d <span class="keywordflow">in</span> np.linspace(0.67, g.d, num=5):</div>
<div class="line">    g_interim = BrillLindquistMetric(d=d, m1=g.m1, m2=g.m2)</div>
<div class="line">    c_inner = find_mots(</div>
<div class="line">        cfg,</div>
<div class="line">        metric=g_interim, <span class="comment"># use the temporary metric</span></div>
<div class="line">        num=c_inner.num,  <span class="comment"># use previous MOTS&#39;s resolution initially</span></div>
<div class="line">        c_ref=c_inner,    <span class="comment"># use the previous MOTS as initial guess</span></div>
<div class="line">        ref_num=25,</div>
<div class="line">        reparam=<span class="stringliteral">&#39;curv2&#39;</span>,  <span class="comment"># enable reparameterization</span></div>
<div class="line">    )</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Plot everything together.</span></div>
<div class="line">BaseCurve.plot_curves(</div>
<div class="line">    (c_AH, <span class="stringliteral">r&quot;$\mathcal{S}_{\rm outer}$&quot;</span>, <span class="stringliteral">&#39;-b&#39;</span>),</div>
<div class="line">    (c_smaller, <span class="stringliteral">r&quot;$\mathcal{S}_1$&quot;</span>, <span class="stringliteral">&#39;:m&#39;</span>),</div>
<div class="line">    (c_larger, <span class="stringliteral">r&quot;$\mathcal{S}_2$&quot;</span>, <span class="stringliteral">&#39;--r&#39;</span>),</div>
<div class="line">    (c_inner, <span class="stringliteral">r&quot;$\mathcal{S}_{\rm inner}$&quot;</span>, <span class="stringliteral">&#39;-g&#39;</span>),</div>
<div class="line">    dpi=100, grid=<span class="keyword">False</span>, legendargs=dict(loc=4),</div>
<div class="line">)</div>
</div><!-- fragment --><p>From here it is easy to reduce <code>d</code> step by step to get to the point where the inner common MOTS and the bottom MOTS disappear. This will require choosing smaller and smaller steps in <code>d</code>.</p>
<h2>Physical quantities</h2>
<p>We can plot, e.g., the Ricci scalar of each curve like this:</p>
<div class="fragment"><div class="line">plot_1d(c_AH.ricci_scalar, points=100, domain=(0, np.pi), value_pad=1e-6,</div>
<div class="line">        title=<span class="stringliteral">r&quot;Ricci Scalar $\mathcal{R}$ of AH&quot;</span>)</div>
</div><!-- fragment --><p>Other quantities are computed simply via:</p>
<div class="fragment"><div class="line">print(<span class="stringliteral">&quot;Stability of larger MOTS:&quot;</span>, c_larger.stability_parameter())</div>
<div class="line">print(<span class="stringliteral">&quot;Area of inner MOTS:&quot;</span>, c_inner.area())</div>
<div class="line"> </div>
<div class="line">_, spectrum = c_inner.stability_parameter(full_output=<span class="keyword">True</span>)</div>
<div class="line">s1, s2 = sorted(spectrum.get().real)[:2]</div>
<div class="line">print(<span class="stringliteral">&quot;Stability parameter of inner MOTS:&quot;</span>, s1)</div>
<div class="line">print(<span class="stringliteral">&quot;2nd stability eigenvalue of inner MOTS:&quot;</span>, s2)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Print the spectrum including all the higher angular modes.</span></div>
<div class="line">spectrum.print_max_l = 5 <span class="comment"># print only the first few ones</span></div>
<div class="line">print(spectrum)</div>
</div><!-- fragment --><h1>Example 2 &ndash; (Almost) fully automated</h1>
<p>For a two-black-hole configuration like in Brill-Lindquist, there is a convenience class <a class="el" href="classmotsfinder_1_1axisym_1_1initialguess_1_1InitHelper.html" title="Helper to find the initial MOTSs for a Brill-Lindquist-like metric.">motsfinder.axisym.initialguess.InitHelper</a>, which automates many of the above steps. It also does not need to modify the metric in order to find the inner common MOTS and instead takes a sequence of constant expansion surfaces to deform the apparent horizon into the inner common MOTS.</p>
<p>In many cases, this <code>InitHelper</code> successfully finds the four MOTSs we already found above (in case they all exist). If not, several parameters can be tweaked allowing it to find the four MOTSs in many other cases too.</p>
<p>Here is a very simple example:</p>
<div class="fragment"><div class="line">g = BrillLindquistMetric(d=0.5, m1=0.2, m2=0.8)</div>
<div class="line">h = InitHelper(</div>
<div class="line">    metric=g, out_base=<span class="stringliteral">&quot;data/my_MOTSs/&quot;</span>,</div>
<div class="line">    suffix=<span class="stringliteral">&quot;d%s_m%s_%s&quot;</span> % (g.d, g.m1, g.m2)</div>
<div class="line">)</div>
<div class="line">curves = h.find_four_MOTSs(m1=g.m1, m2=g.m2, d=g.d, plot=<span class="keyword">True</span>)</div>
</div><!-- fragment --><p>The generated MOTSs are not found to very high accuracy but they are perfectly suited as initial guesses (i.e. reference curves) for a more precise search:</p>
<div class="fragment"><div class="line">cfg = GeneralMotsConfig.preset(</div>
<div class="line">    <span class="stringliteral">&#39;general&#39;</span>, metric=g, reparam=<span class="stringliteral">&#39;curv2&#39;</span>, ref_num=15, verbose=<span class="keyword">True</span>,</div>
<div class="line">)</div>
<div class="line">curves_accurate = []</div>
<div class="line"><span class="keywordflow">for</span> c_ref <span class="keywordflow">in</span> curves:</div>
<div class="line">    c = find_mots(cfg, c_ref=c_ref, num=c_ref.num)</div>
<div class="line">    curves_accurate.append(c)</div>
<div class="line"> </div>
<div class="line">BaseCurve.plot_curves(</div>
<div class="line">    (curves_accurate[0], <span class="stringliteral">r&quot;$\mathcal{S}_{\rm outer}$&quot;</span>, <span class="stringliteral">&#39;-b&#39;</span>),</div>
<div class="line">    (curves_accurate[1], <span class="stringliteral">r&quot;$\mathcal{S}_1$&quot;</span>, <span class="stringliteral">&#39;:m&#39;</span>),</div>
<div class="line">    (curves_accurate[2], <span class="stringliteral">r&quot;$\mathcal{S}_2$&quot;</span>, <span class="stringliteral">&#39;--r&#39;</span>),</div>
<div class="line">    (curves_accurate[3], <span class="stringliteral">r&quot;$\mathcal{S}_{\rm inner}$&quot;</span>, <span class="stringliteral">&#39;-g&#39;</span>),</div>
<div class="line">    dpi=100, grid=<span class="keyword">False</span>, legendargs=dict(loc=4),</div>
<div class="line">)</div>
</div><!-- fragment --><h1>References:</h1>
<p>[1] Brill, Dieter R., Lindquist, R. W. "Interaction Energy in
    Geometrostatics." Phys. Rev. 131, 471 (1963). <a href="https://journals.aps.org/pr/abstract/10.1103/PhysRev.131.471">https://journals.aps.org/pr/abstract/10.1103/PhysRev.131.471</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
