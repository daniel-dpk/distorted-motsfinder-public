<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MOTS Finder: motsfinder.axisym.shooting.shooting Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxystyle_tweaks.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MOTS Finder
   &#160;<span id="projectnumber">v1.5</span>
   </div>
   <div id="projectbrief">Find non-star-shaped MOTSs</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespacemotsfinder_1_1axisym_1_1shooting_1_1shooting.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">motsfinder.axisym.shooting.shooting Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Find axisymmetric MOTSs and MOTOSs using a shooting method.  
<a href="namespacemotsfinder_1_1axisym_1_1shooting_1_1shooting.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmotsfinder_1_1axisym_1_1shooting_1_1shooting_1_1ShootingMethodError.html">ShootingMethodError</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Raised when an error occurs while integrating the coupled ODEs.  <a href="classmotsfinder_1_1axisym_1_1shooting_1_1shooting_1_1ShootingMethodError.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a668fd6354b5c43a9f46d46f6912acc6f"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemotsfinder_1_1axisym_1_1shooting_1_1shooting.html#a668fd6354b5c43a9f46d46f6912acc6f">shooting_method</a> (metric, z0, x0=0.0, P_dot=1.0, Z_dot=0.0, s_max=np.inf, axis_tol=1e-5, max_domain=10.0, rtol=1e-8, atol=1e-12, method=&quot;RK45&quot;, eps=1e-6, bad_metric=False, normal=&quot;left&quot;, verbose=False, unload=True, **kw)</td></tr>
<tr class="memdesc:a668fd6354b5c43a9f46d46f6912acc6f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solve the MOT(O)S problem using a shooting method.  <a href="namespacemotsfinder_1_1axisym_1_1shooting_1_1shooting.html#a668fd6354b5c43a9f46d46f6912acc6f">More...</a><br /></td></tr>
<tr class="separator:a668fd6354b5c43a9f46d46f6912acc6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d20f10e1fba024d102a4ab3c23dbbb8"><td class="memItemLeft" align="right" valign="top"><a id="a0d20f10e1fba024d102a4ab3c23dbbb8"></a>
def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemotsfinder_1_1axisym_1_1shooting_1_1shooting.html#a0d20f10e1fba024d102a4ab3c23dbbb8">_shooting_method</a> (metric, z0, x0, P_dot, Z_dot, s_max, axis_tol, max_domain, rtol, atol, method, eps, bad_metric, normal, verbose, **kw)</td></tr>
<tr class="memdesc:a0d20f10e1fba024d102a4ab3c23dbbb8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implements <a class="el" href="namespacemotsfinder_1_1axisym_1_1shooting_1_1shooting.html#a668fd6354b5c43a9f46d46f6912acc6f" title="Solve the MOT(O)S problem using a shooting method.">shooting_method()</a>. <br /></td></tr>
<tr class="separator:a0d20f10e1fba024d102a4ab3c23dbbb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe700596347ec215bc073d5b184cbdcc"><td class="memItemLeft" align="right" valign="top"><a id="abe700596347ec215bc073d5b184cbdcc"></a>
def&#160;</td><td class="memItemRight" valign="bottom"><b>_handle_departure_from_axis</b> (metric, curv, x0, z0, eps, bad_metric, normal, T, verbose=False)</td></tr>
<tr class="separator:abe700596347ec215bc073d5b184cbdcc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a654d42284c0677323e56a8093fba8c25"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemotsfinder_1_1axisym_1_1shooting_1_1shooting.html#a654d42284c0677323e56a8093fba8c25">get_termination_reason</a> (sol)</td></tr>
<tr class="memdesc:a654d42284c0677323e56a8093fba8c25"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return a string indicating why the shooting method terminated.  <a href="namespacemotsfinder_1_1axisym_1_1shooting_1_1shooting.html#a654d42284c0677323e56a8093fba8c25">More...</a><br /></td></tr>
<tr class="separator:a654d42284c0677323e56a8093fba8c25"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Find axisymmetric MOTSs and MOTOSs using a shooting method. </p>
<p><b>Examples</b> </p>
<div class="fragment"><div class="line"><span class="keyword">from</span> <a class="code" href="namespacemotsfinder_1_1axisym_1_1shooting.html">motsfinder.axisym.shooting</a> <span class="keyword">import</span> shooting_method</div>
<div class="line"><span class="keyword">from</span> <a class="code" href="namespacemotsfinder_1_1metric.html">motsfinder.metric</a> <span class="keyword">import</span> BrillLindquistMetric</div>
<div class="line"><span class="keyword">from</span> <a class="code" href="namespacemotsfinder_1_1ipyutils.html">motsfinder.ipyutils</a> <span class="keyword">import</span> plot_data</div>
<div class="line"> </div>
<div class="line">g = BrillLindquistMetric(d=0.6, m1=0.2, m2=0.8)</div>
<div class="line">sol = shooting_method(</div>
<div class="line">    metric=g, verbose=<span class="keyword">True</span>,</div>
<div class="line">    z0=0.44462406985175074,  <span class="comment"># outer common MOTS (S_outer)</span></div>
<div class="line">    <span class="comment">#z0=0.3740659586129742,   # inner common MOTS (S_inner)</span></div>
<div class="line">    <span class="comment">#z0=0.36239042407655525,  # smaller individual MOTS (S_1)</span></div>
<div class="line">    <span class="comment">#z0=0.005761670102647809, # larger individual MOTS (S_2)</span></div>
<div class="line">    <span class="comment">#z0=0.4441263027,         # MOTS that wraps around</span></div>
<div class="line">    <span class="comment">#z0=0.445, max_domain=2,  # a MOTOS</span></div>
<div class="line">)</div>
<div class="line">S = sol.t</div>
<div class="line">P, Z, _, _ = sol.y</div>
<div class="line"> </div>
<div class="line">plot_data(</div>
<div class="line">    P, Z, figsize=(3.6, 3.6), dpi=120, xlabel=<span class="stringliteral">&quot;$x/M$&quot;</span>, ylabel=<span class="stringliteral">&quot;$z/M$&quot;</span>,</div>
<div class="line">    subplot_kw=dict(aspect=<span class="stringliteral">&quot;equal&quot;</span>), pad=<span class="stringliteral">&quot;20%&quot;</span>,</div>
<div class="line">)</div>
<div class="ttc" id="anamespacemotsfinder_1_1axisym_1_1shooting_html"><div class="ttname"><a href="namespacemotsfinder_1_1axisym_1_1shooting.html">motsfinder.axisym.shooting</a></div><div class="ttdoc">Shooting method for finding MOTSs and MOTOSs in manifest axisymmetry.</div><div class="ttdef"><b>Definition:</b> __init__.py:1</div></div>
<div class="ttc" id="anamespacemotsfinder_1_1ipyutils_html"><div class="ttname"><a href="namespacemotsfinder_1_1ipyutils.html">motsfinder.ipyutils</a></div><div class="ttdoc">Utility functions for interactive IPython/Jupyter sessions.</div><div class="ttdef"><b>Definition:</b> __init__.py:1</div></div>
<div class="ttc" id="anamespacemotsfinder_1_1metric_html"><div class="ttname"><a href="namespacemotsfinder_1_1metric.html">motsfinder.metric</a></div><div class="ttdoc">Metric and metric tensors.</div><div class="ttdef"><b>Definition:</b> __init__.py:1</div></div>
</div><!-- fragment --> </div><h2 class="groupheader">Function Documentation</h2>
<a id="a654d42284c0677323e56a8093fba8c25"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a654d42284c0677323e56a8093fba8c25">&#9670;&nbsp;</a></span>get_termination_reason()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def motsfinder.axisym.shooting.shooting.get_termination_reason </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sol</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return a string indicating why the shooting method terminated. </p>
<p>Possible reasons are: </p><pre class="fragment">* ``"axis_hit"``: When the curve hit the axis.
* ``"domain_reached"``: When the curve left the specified domain.
* ``"end"``: `s_max` reached.
* ``"failure"``: Integration step failed.
* ``"other"``: Unknown reason.
</pre> 
</div>
</div>
<a id="a668fd6354b5c43a9f46d46f6912acc6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a668fd6354b5c43a9f46d46f6912acc6f">&#9670;&nbsp;</a></span>shooting_method()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def motsfinder.axisym.shooting.shooting.shooting_method </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>metric</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>z0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x0</em> = <code>0.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>P_dot</em> = <code>1.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Z_dot</em> = <code>0.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>s_max</em> = <code>np.inf</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>axis_tol</em> = <code>1e-5</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>max_domain</em> = <code>10.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rtol</em> = <code>1e-8</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>atol</em> = <code>1e-12</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>method</em> = <code>&quot;RK45&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>eps</em> = <code>1e-6</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>bad_metric</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>normal</em> = <code>&quot;left&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>verbose</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>unload</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">**&#160;</td>
          <td class="paramname"><em>kw</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Solve the MOT(O)S problem using a shooting method. </p>
<p>Given a metric and initial conditions, this function integrates a system of ODEs to construct a curve representing a surface of zero outward expansion. If the curve starts and terminates on the z-axis (or closes upon itself away from the axis), it represents a closed surface, i.e. a MOTS (if it closes away from the z-axis, the surface has toroidal topology). Otherwise, the surface is open, i.e. a MOTOS.</p>
<p>Integration is stopped when the z-axis is hit or when a given maximum distance from the coordinate origin is reached.</p>
<p>Note that the current implementation assumes vanishing spin.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">metric</td><td>The metric object which contains methods to obtain the slice 3-metric and extrinsic curvature. </td></tr>
    <tr><td class="paramname">z0</td><td>Coordinate on the symmetry axis (z-axis) at which to start the ray. </td></tr>
    <tr><td class="paramname">x0</td><td>x-coordinate of the starting point. Should be 0 for curves starting from the z-axis. Default is 0. </td></tr>
    <tr><td class="paramname">P_dot,Z_dot</td><td>Initial direction to shoot in (in the x,z coordinate plane). The given values will be normalized to a unity tangent vector. The direction should be perpendicular to the z-axis if the curve starts on the z-axis. This is also the default, i.e. <code>P_dot=1.0, Z_dot=0.0</code>. </td></tr>
    <tr><td class="paramname">s_max</td><td>Maximal proper length of the curve. Default is to not limit the proper length and integrate until one of the other termination conditions is reached. </td></tr>
    <tr><td class="paramname">axis_tol</td><td>Tolerance for detecting termination when hitting the z-axis. A curve starting and ending at the z-axis represents a smooth closed surface (i.e. a MOTS). However, numerically the axis will not be reached exactly before small numerical noise leads to the curve turning away from the axis. If the curve gets closer than the given tolerance (default is <code>1e-5</code>) in its x-coordinate, then a curve that actually terminates on the axis most likely exists in a small neighborhood of the found curve. </td></tr>
    <tr><td class="paramname">max_domain</td><td>Maximum coordinate distance from the origin in the (x,z)-coordinate plane the curve can travel. Integration is stopped as soon as the curve crosses this boundary. Default is <code>10.0</code>. </td></tr>
    <tr><td class="paramname">rtol,atol</td><td>Tolerances for the <code>scipy.integrate.solve_ivp()</code> call. Default is <code>rtol=1e-8, atol=1e-12</code>. See the <code>SciPy</code> documentation for more information. </td></tr>
    <tr><td class="paramname">method</td><td>Method to use in the <code>scipy.integrate.solve_ivp()</code> call. Possible options depend on the installed <code>SciPy</code> version. Default is <code>"RK45"</code>. </td></tr>
    <tr><td class="paramname">eps</td><td>Closest distance to the z-axis to consider. This function currently does not handle the case of <code>x</code> going to zero. We hence cut off the x-value at <code>eps</code> (default <code>1e-6</code>) and assume the error is negligible. If you get errors due to <code>NaN</code> values during integration, this value might have to be increased. Correctly handling this limit is planned. </td></tr>
    <tr><td class="paramname">bad_metric</td><td>Whether the metric cannot be evaluated closer than <code>eps</code> to the z-axis. Default is <code>False</code>, i.e. we may evaluate the metric and extrinsic curvature on the z-axis. </td></tr>
    <tr><td class="paramname">normal</td><td>The normal which should have vanishing expansion. Poissible are <code>"left"</code> (default) and <code>"right"</code>. </td></tr>
    <tr><td class="paramname">verbose</td><td>Whether to print information on why integration was stopped, even in case of success. Default is <code>False</code>. </td></tr>
    <tr><td class="paramname">unload</td><td>Whether to unload any loaded numerical data from the metric after execution to free up memory. Default is <code>True</code>. </td></tr>
    <tr><td class="paramname">**kw</td><td>Further arguments are passed to <code>scipy.integrate.solve_ivp()</code> without modification. Relevant arguments include e.g. <code>max_step</code>. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacemotsfinder.html">motsfinder</a></li><li class="navelem"><a class="el" href="namespacemotsfinder_1_1axisym.html">axisym</a></li><li class="navelem"><a class="el" href="namespacemotsfinder_1_1axisym_1_1shooting.html">shooting</a></li><li class="navelem"><a class="el" href="namespacemotsfinder_1_1axisym_1_1shooting_1_1shooting.html">shooting</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
